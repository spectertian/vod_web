{% extends 'base.html.twig' %}
{% block body %}
    <div id="block-B" data-focus="" class="qy-carousel-wrap">
        <div class="qy-carousel-maskbottom"></div>
        <div class="typetag wwp returl cf" style="z-index: 9">
            <div class="module_mod">
                <div class="common_container cf">
                    <div class="mod_list_filter">
                        <dl class="fed-col-sx12">
                            <dt>分类<a class="title" href="{{ path("show_category",{'type':type}) }}">全部<span class="fa tb3">&#xe62d;</span></a></dt>
                            {% for k,info in attribute(typeList.list,type).tag %}
                                {% if k!=0 %}
                                    <dd><a href="{{ path("show_category",{'type':type,'tag':k}) }}">{{ info }}</a></dd>
                                {% endif %}
                            {% endfor %}
                        </dl>
                        <div class="homepage_cut_line l"></div>
                        <dl class="fed-col-sx12">
                            <dt>地区<a class="title" href="{{ path("show_category",{'type':type}) }}">全部<span class="fa tb3">&#xe62d;</span></a></dt>
                            {% for k,info in attribute(typeList.list,type).area %}
                                {% if k!=0 %}
                                    <dd><a href="{{ path("show_category",{'type':type,'area':k}) }}">{{ info }}</a></dd>
                                {% endif %}
                            {% endfor %}
                        </dl>
                        <div class="homepage_cut_line l"></div>
                        <dl class="fed-col-sx12">
                            <dt>年代<a class="title" href="{{ path("show_category",{'type':type}) }}">全部<span class="fa tb3">&#xe62d;</span></a></dt>
                            {% for k,info in attribute(typeList.list,type).year %}
                                {% if k!=0 %}
                                    <dd><a href="{{ path("show_category",{'type':type,'year':k}) }}">{{ info }}</a></dd>
                                {% endif %}
                            {% endfor %}
                        </dl>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="wwp index-hotnow wow fadeInUp top20 animated" style="visibility: visible; animation-name: fadeInUp;">
        <div class="title-a cf">
            <h2 class="title-name l cf">
                <img src="{{ asset("cy/7.png") }}"><span>正在热播</span><a class="url" href="https://chongtmtv.com/index.php/label/rb.html" onselectstart="return false;">更多<i class="fa tb3"></i></a>
            </h2>
        </div>
        <div class="vodlist hotgrow size listdh" id="hot1">
            {% for k,info in hotList %}
                <div class="pack-ykpack hot{{ k+1 }}">
                    <div class="pack-packcover returl list-top-b">
                        <a class="aplus-exp ecimgbor" target="_self" href="{{ path('detail',{id:info.id}) }}" title="{{ info.title }}">
                            <div class="bj eclazy" data-original="{{ path('img',{id:info.imgUrl}) }}" style="background-image: url({{ asset("cy/lh.png") }}); display: block;"></div>
                            <span class="pack-bg"></span>
                            <span class="pack-prb hidden">{{ info.vodRemarks }}</span>
                        </a>
                    </div>
                    <div class="pack-infolist">
                        <a class="vodname hidden" target="_self" href="{{ path('detail',{id:info.id}) }}" title="{{ info.title }}">{{ info.title }}</a>
                        <div class="pack-subtitle cor3 hidden">{{ info.stars| join(',') }}</div>
                    </div>
                </div>
            {% endfor %}
        </div>
    </div>
    <div class="wwp">
        {#        <div class="ec-ad top20"><a href="#" target="_blank"><img src="{{ asset("cy//c368ab3bd91d2cf894a9f78d02cec598.png") }}" alt="影视列表分类横幅广告位"></a></div> #}
    </div>
    <div class="wwp wow fadeInUp animated" style="visibility: visible; animation-name: fadeInUp;">
        {% for key,infos in list %}
            <div class="wwp public wow fadeInUp top20 animated" style="visibility: visible; animation-name: fadeInUp;">
                <div class="title-a cf">
                    <h2 class="title-name l cf">
                        <span>{{ nameList[key] }}</span><a class="url" href="{{ path("show_category_sq",{'type':"1",'tag':nameList[key]}) }}">更多<i class="fa tb3"></i></a>
                    </h2>
                    <div class="title-tab l">
                    </div>
                </div>
                <div class="vodlist hotgrow size listdh">
                    {% for k,info in infos %}
                        <div class="pack-ykpack hide{{ k+1 }}">
                            <div class="pack-packcover returl list-top-b">
                                <a class="aplus-exp ecimgbor" target="_self" href="{{ path('play_sq',{s_id:info.id,p_id:0}) }}" title="{{ info.title }}">
                                    <div class="bj eclazy" data-original="{{ path('img',{id:info.imgUrl}) }}" style="background-image: url({{ asset("cy/lh.png") }}); display: block;"></div>
                                    <span class="pack-bg"></span>
                                    <span class="pack-prb hidden">{{ info.vodRemarks }}</span>
                                </a>
                            </div>
                            <div class="pack-infolist">
                                <a class="vodname hidden" target="_self" href="{{ path('play_sq',{s_id:info.id,p_id:0}) }}" title="{{ info.title }}">{{ info.title }}</a>
                                <div class="pack-subtitle cor3 hidden">{{ info.stars| join(',') }}</div>
                            </div>
                        </div>
                    {% endfor %}
                </div>
            </div>
        {% endfor %}
    </div>
    <script>
        var viewHeight = document.documentElement.clientHeight//获取可视区高度
        function lazyload() {
            var eles = document.querySelectorAll('div[data-original]')
            Array.prototype.forEach.call(eles, function (item, index) {
                var rect
                if (item.dataset.original === "")
                    return
                rect = item.getBoundingClientRect()// 用于获得页面中某个元素的左，上，右和下分别相对浏览器视窗的位置
                if (rect.bottom >= 0 && rect.top < viewHeight) {
                    !function () {
                        var img = new Image()
                        img.src = item.dataset.original
                        img.onload = function () {
                            item.style.backgroundImage = "url(" + img.src + ")";

                        }
                        item.removeAttribute("data-original")//移除属性，下次不再遍历
                        item.removeAttribute("lazyload")
                    }()
                }
            })
        }

        lazyload()//刚开始还没滚动屏幕时，要先触发一次函数，初始化首页的页面图片
        document.addEventListener("scroll", lazyload)
    </script>
{% endblock %}

